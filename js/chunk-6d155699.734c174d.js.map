{"version":3,"sources":["webpack:///./src/components/Card.vue?2791","webpack:///./src/components/Card.vue?46d3","webpack:///./src/components/Card.vue","webpack:///./src/components/Card.vue?c496","webpack:///./src/components/Card.vue?2ed8","webpack:///./src/views/Selector.vue?8205","webpack:///./src/lib/activity_picker.ts","webpack:///src/views/Selector.vue","webpack:///./src/views/Selector.vue?a785","webpack:///./src/views/Selector.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_t","staticRenderFns","extend","name","mounted","resizeTextSize","window","addEventListener","destroyed","removeEventListener","methods","$el","style","fontSize","clientHeight","component","_l","activity","index","_obj","key","class","sat","highlight","desat","_v","_s","capitalize","getProbabilities","bombProbability","nonBomb","normalize","arr","sum","reduce","total","cur","map","fixProbability","probability","history","totalPicks","tmpProbability","i","length","Math","max","pick","store","state","activityHistory","choice","random","commit","console","warn","floor","components","Card","data","delay","$store","animationTimeS","timeoutIds","activities","computed","push","setTimeout","roll","initialDelay","resolve","clearTimeouts","goPlay","type","$router","replace","$root","$emit","txt","toUpperCase","slice","selectedActivity","tutorialStep","forEach"],"mappings":"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","file":"js/chunk-6d155699.734c174d.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Card.vue?vue&type=style&index=0&id=447e02d4&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"outer elevation-4\"},[_c('div',{staticClass:\"inner\"}),_vm._t(\"default\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue';\n\nexport default Vue.extend({\n  name: 'Card',\n  mounted() {\n    this.resizeTextSize();\n    window.addEventListener('resize', this.resizeTextSize);\n  },\n  destroyed() {\n    window.removeEventListener('resize', this.resizeTextSize);\n  },\n  methods: {\n    resizeTextSize() {\n      (this.$el as HTMLElement).style.fontSize = `${0.4 * this.$el.clientHeight}px`;\n    },\n  },\n});\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Card.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Card.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Card.vue?vue&type=template&id=447e02d4&scoped=true&\"\nimport script from \"./Card.vue?vue&type=script&lang=ts&\"\nexport * from \"./Card.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Card.vue?vue&type=style&index=0&id=447e02d4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"447e02d4\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',_vm._l((_vm.activities),function(activity,index){\nvar _obj;\nreturn _c('Card',{key:activity,class:( _obj = {\n      sat: index === _vm.highlight,\n      desat: _vm.highlight != null && index !== _vm.highlight}, _obj[activity] = true, _obj )},[_vm._v(_vm._s(_vm.capitalize(activity)))])}),1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","function getProbabilities(bombProbability: number): number[] {\n  const nonBomb = (1 - bombProbability) / 3;\n  return [nonBomb, nonBomb, nonBomb, bombProbability];\n}\nfunction normalize(arr: number[]): number[] {\n  const sum = arr.reduce((total: number, cur: number) => total + cur, 0);\n  return arr.map((cur: number) => cur / sum);\n}\n\nfunction fixProbability(probability: number[], history: number[]): number[] {\n  const totalPicks = history.reduce((sum: number, cur: number) => sum + cur, 0);\n  const tmpProbability = probability;\n  if (totalPicks > 0) {\n    for (let i = 0; i < probability.length; i += 1) {\n      tmpProbability[i] = Math.max(0, 2 * tmpProbability[i] - history[i] / (totalPicks + 2));\n    }\n  }\n  return normalize(tmpProbability);\n}\ntype Store = {\n  state: {\n    activityHistory: number[];\n    bombProbability: number;\n  };\n  commit: (a: string, b: number) => void;\n};\n\nfunction pick(store: Store): number {\n  const probability = fixProbability(\n    getProbabilities(store.state.bombProbability),\n    store.state.activityHistory,\n  );\n  let choice = Math.random();\n  for (let i = 0; i < probability.length; i += 1) {\n    if (probability[i] >= choice) {\n      store.commit('updateActivityHistory', i);\n      return i;\n    }\n    choice -= probability[i];\n  }\n  // Fallback return. This should never happen\n  console.warn('Was unable to pick activity the proper way. Choosing randomly.', probability);\n  return Math.floor(Math.random() * probability.length);\n}\n\nexport default pick;\n","<template>\n  <div>\n    <Card\n      v-for=\"(activity, index) in activities\"\n      :key=\"activity\"\n      :class=\"{\n        sat: index === highlight,\n        desat: highlight != null && index !== highlight,\n        [activity]: true}\"\n    >{{ capitalize(activity) }}</Card>\n  </div>\n</template>\n\n<style lang=\"scss\">\n</style>\n\n<script>\n// @ is an alias to /src\nimport { mapState } from 'vuex';\nimport Card from '@/components/Card.vue';\nimport activityPicker from '@/lib/activity_picker';\n\nexport default {\n  name: 'Selector',\n  components: {\n    Card,\n  },\n  data() {\n    return {\n      highlight: null,\n      delay: this.$store.state.animationTimeS * 33,\n      timeoutIds: [null],\n      activities: ['speak', 'draw', 'show'],\n    };\n  },\n  computed: mapState(['tutorialStep']),\n  mounted() {\n    // Setup animation\n    const initialDelay = this.$store.state.animationTimeS * 66;\n    this.timeoutIds.push(setTimeout(this.roll, initialDelay));\n    this.timeoutIds.push(setTimeout(this.resolve, initialDelay + this.delay * 10));\n  },\n  destroyed() {\n    this.clearTimeouts();\n  },\n  methods: {\n    goPlay(type) {\n      if (type === 'bomb') {\n        this.$router.replace('/play/bomb');\n      } else {\n        this.$root.$emit('play', type);\n        this.$router.replace({ name: 'Play', params: { type } });\n      }\n    },\n    capitalize(txt) {\n      if (!txt || !txt.length) return txt;\n      return txt[0].toUpperCase() + txt.slice(1);\n    },\n    roll() {\n      this.highlight = (this.highlight + 1) % 3;\n      this.delay = Math.max(this.delay * 0.92, 100);\n      this.$root.$emit('play', 'select');\n      this.timeoutIds[0] = setTimeout(this.roll, this.delay);\n    },\n    resolve() {\n      const selectedActivity = this.tutorialStep < 0 ? activityPicker(this.$store) : 0;\n      if (selectedActivity === 3) {\n        this.timeoutIds.push(setTimeout(() => this.goPlay('bomb'), 2000));\n      } else {\n        this.clearTimeouts();\n        if (this.tutorialStep > 0) this.$store.commit('tutorialNext');\n        this.highlight = selectedActivity;\n        for (let delay = 200; delay < 1300; delay += 200) {\n          this.timeoutIds.push(setTimeout(() => {\n            if (this.highlight === -1) this.$root.$emit('play', 'selected');\n            this.highlight = this.highlight === -1 ? selectedActivity : -1;\n          }, delay));\n        }\n        if (this.tutorialStep < 0) {\n          this.timeoutIds.push(\n            setTimeout(() => this.goPlay(this.activities[selectedActivity]), 3000),\n          );\n        }\n      }\n    },\n    clearTimeouts() {\n      this.timeoutIds.forEach((timeoutId) => clearTimeout(timeoutId));\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Selector.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Selector.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Selector.vue?vue&type=template&id=51ae9299&\"\nimport script from \"./Selector.vue?vue&type=script&lang=js&\"\nexport * from \"./Selector.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}